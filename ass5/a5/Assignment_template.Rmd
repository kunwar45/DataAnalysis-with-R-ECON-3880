---
title: "ECON 3880: Assignment 5"
author: "Iman Ullah and Kunwar Nir" 

date: '`r Sys.Date()`'
output: 
  html_notebook: 
    toc: yes
    toc_float: yes
    df_print: paged
    number_sections: true
---
Do not change anything above this line except your name, even a single space!


# Q1:

Question 1 goes here.

```{r echo=TRUE}

library(tidyverse)
library(statcanR)
library(janitor)
library(ggplot2)
LF <- statcan_download_data("14-10-0106-01", lang = "eng")

LF <- clean_names(LF)
LF <- LF %>%
  select(ref_date, geo, labour_force_characteristics, population_centre_and_rural_areas, sex, age_group, value)



LF_filtered <-
  LF |> filter(
    substr(ref_date, 1, 4) == "2019" &
    population_centre_and_rural_areas == "Total, all population centres and rural areas" &
    labour_force_characteristics == "Unemployment rate" &
    age_group %in% c("15 to 24 years", "25 to 44 years")
  )

LF_25_44 <- LF_filtered %>%
  filter(age_group == "25 to 44 years")

unemployment_table <- LF_25_44 %>%
  select(geo, sex, value) %>%
  pivot_wider(names_from = sex, values_from = value)


ggplot(unemployment_table, aes(x = geo)) +
  geom_point(aes(y = Females, color = "Female"), size = 3) +
  geom_point(aes(y = Males, color = "Male"), size = 3) +
  geom_segment(aes(x = geo, xend = geo, y = Females, yend = Males), color = "gray", linetype = "dashed") + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

```

We see the biggest gaps in unemployment rate in Prince Edward Island, Newfoundland and labrador, Nova Scotia and New Brunswick

# Q2:

Question 2 here.

```{r echo=TRUE}

library(readxl)

df <- read_excel("assignment5_data.xlsx", sheet = "dataa", skip =1)
model <- lm(y ~ x1 + x2 + x3 + z, data = df)
summary(model)

```

X2 is statistically significant and z is marginally significant
 
# Q3:

Question 3 here.

```{r echo=TRUE}
average_y <- mean(df$y, na.rm = TRUE)
df <- df %>%
  mutate(y_group = ifelse(y > average_y, 1, 0))

logit_model <- glm(y_group ~ x1 + x2 + x3 + z, data = df, family = binomial)
summary(logit_model)



library(regclass)
cm <-confusion_matrix(logit_model)
print(cm)
```
```{r echo=TRUE}
TN <- cm[1, 1]
FP <- cm[1, 2]
FN <- cm[2, 1]
TP <- cm[2, 2]
accuracy <- (TN + TP) / (TN + TP + FN + FP)
print(accuracy)
```
Accuracy rate is about 64%





Also remember that you need to run all the code chunks and then save the file before clicking on Preview. After clicking on Preview, RStudio will save a file in your computer with an extension of *nb.html*; for example, **Assignment1.nb.html**, which you will send it to me.

***Good luck!***



