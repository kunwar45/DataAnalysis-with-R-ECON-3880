---
title: "ECON 3880: Assignment 2"
author: "Iman Ullah, Kunwar Nir" 

date: '`r Sys.Date()`'
output: 
  html_notebook: 
    toc: yes
    toc_float: yes
    df_print: paged
    number_sections: true
---
Do not change anything above this line except your name, even a single space!

```{r}
# Load data and libraries
install.packages("ggplot2")
library(ggplot2)
df <- read.csv('insurance.csv')
```

# Q1:

Question 1 goes here.

```{r}
ggplot(data = df, aes(x = region, fill = sex)) +
  geom_bar() +
  labs(title = "Count Plot of Observations by Region and Sex",
       x = "Region",
       y = "Count")
```

Here you will type the answer to the Q1, if need be. 

Southeast has the highest number of observations, the other three seem to be equal. 

# Q2:

Question 2 here.

```{r}
# Your code here
ggplot(data =df, aes(x = bmi, y = charges, color = smoker)) +
  geom_point() +
  geom_smooth( method = lm) + 
  labs(title = " The link between BMI and Charges: Smokers and nonsmokers.",
       x = "Body Mass Index",
       y = "Dollar Charged",
       color = "Smoker")
  
  "Conclusion: there is a positive correlation between BMI and charges for smokers"
```
Your answer to Q2 here.
Conclusion:
For smokers, the slope is higher, while for non-smokers the slope is almost horizontal. There is a positive correlation between BMI and charges for both. Therefore, as BMI increases, the dollars charged increases at a higher rate for smokers than for non-smokers.
 
# Q3:

Question 3 here.

```{r}
# Your code here to answer Q3
ggplot(data = df, aes(x = region, fill = smoker)) +
  geom_bar(position = "stack") +
  coord_flip() +
  theme_minimal() +
  geom_text(stat = "count", aes(label = after_stat(count)), position = position_stack(vjust = 0.5)) +
  scale_fill_brewer(palette = "Dark2") +
  labs(title = "Stacked Bar Chart of Smokers and Non-Smokers by Region",
       x = "Region",
       y = "Count",
       fill = "Smoker")
```

Your answer to Q3 here.


# Q4:

Question 4 here.

```{r}
# Your code here
library(plotly)
plot_ly(data = df, x = ~bmi, y = ~charges, color = ~region, type = 'scatter', mode = 'markers') %>%
  layout(title = "Interactive Scatter Plot of BMI vs Charges",
         xaxis = list(title = "BMI"),
         yaxis = list(title = "Charges"))
```




***Good luck!***


