---
title: "Assignment 1 - Suggested Answers"
author: "Firouz Fallahi"

date: '`r Sys.Date()`'
output: 
  html_notebook: 
    toc: yes
    toc_float: yes
    df_print: paged
    number_sections: true
---

Download and read the data set called insurance.csv into R and call it **df**. This data shows personal information and medical insurance cost charged for several individuals and has been used in Machine Learning with R by Brett Lantz. Next, install and load the *Tidyverse* package into R.

```{r}
# install.packages("tidyverse") 
# if you want to install it again just remove  # from the beginning of the above line
library(tidyverse)

df <- read_csv("insurance.csv")
```

# 

Create a histogram chart for the variable **charges** and color them **blue** and fill them in **red**.

```{r}

ggplot(df) + geom_histogram( aes(x=charges), color='blue', fill='red')
```

# 

Repeat the above plot again but instead of a histogram, create density plots and fill them according to the variable **Smoker** and also use the argument **alpha = 0.5** to make the densities transparent. Is there any differences between smokers and non-smokers? Hint: note that smoker is a variable included in the data set.

```{r}
ggplot(df) + geom_density(mapping = aes(x=charges , fill= smoker),
                          alpha =0.5, 
                            color='blue') 

```

This graph shows that in general those who do not smoke have been charged less compared to those who smoke. In addition, the curve for smokers is a bimodal distribution, which indicates that there are two types of smokers in terms of charges; the second group of smokers has much higher charges than the first group.

# 

Is there any regional differences in density curves of charges among **smokers** and **non-smokers**? To show these differences create a graph and explain if you see any differences. (hint: you can use facet here).

```{r}
ggplot(df) + geom_density(mapping = aes(x=charges , fill= smoker),
                          alpha =0.5, 
                            color='blue') +
        facet_wrap(~region)

```
Overall the distribution curves for non-smokers seem to be similar among the regions and most of them have been charged less than 1000 dollars. However, for smokers we see some regional similarities and differences. 1) Similarity: In all regions the curves are bimodal. 2) Differences: Smokers in southeast and southwest have been charged higher than the other regions.  

# 

Install a package called **ggthemes** and load it into R. Next, create a boxplot chart for **Charges** and fill them based on **Smoker** and show the regional differences. Then, flip the axes and also change the theme to economist, which is included in the **ggtheme** package

```{r}
library(ggthemes)
ggplot(df) + geom_boxplot(mapping = aes(x=charges , fill= smoker),
                          color='blue') +
        facet_wrap(~region) +
        coord_flip() +
        theme_economist()

```


The main difference between the boxplots and violin plots is that the boxplots show the median, first and third quartiles and it does not provide any information about the distribution of observations around these points. On the other hand, violin plots show these observations are mostly distributed around the quarter 3 for male and almost equally around quarter 1 and 3 for female. 